@startuml

class FilterEngine {
    prepareToPlay(sampleRate, samplesPerBlock)
    processBlock(buffer)
}

abstract Filter {
    prepareToPlay(sampleRate, samplesPerBlock)
    processBlock(buffer, numProcessed, samplesThisTime)
}

abstract BWFilter {
    updateCoeffs() 
}

abstract BW4LPHP
class MoogFilter 

class BWHighPFilter
class BWLowPFilter
class QuadFilter {
    setCoeffs(b0, b1, b2, a1, a2)
    processSample(x)
    reset()
}
class FilterModulatorAudioProcessorEditor 
class FilterModulatorAudioProcessor

abstract Modulator {
    prepareToPlay(sampleRate, samplesPerBlock)
    getModulatedCutoff(float cutoff, int samplesPerBlock)  
    setRate(float rateHz)
}

class StepSequencer {
    prepareToPlay(sampleRate, samplesPerBlock)
    getModulatedCutoff(float cutoff, int samplesPerBlock)
    setFilter(index, cutoff)
    setNumActiveSteps(int n)
}

enum WaveType { 
    Sin
    Square
    Triangle
    Saw
}

enum MoogType { 
    MoogLP
    MoogHP
    MoogBP 
}

class WaveGenerator {
    prepareToPlay(sampleRate)
    setFrequency(newFreq)
    getNextValue(samplesPerBlock)
    setWaveType(wt)
}


class Oscillator {
    prepareToPlay(sampleRate, samplesPerBlock)
    setWaveType(type)
    setDepth(semitoneDepth)
}

FilterModulatorAudioProcessorEditor o-right- FilterModulatorAudioProcessor
FilterModulatorAudioProcessor "1" *-- "1" FilterEngine
Filter <|-- BWFilter
Filter <|-- MoogFilter
BWFilter <|-- BW4LPHP
BWFilter <|-- BWNotch
BW4LPHP <|-- BWHighPFilter
BW4LPHP <|-- BWLowPFilter
FilterEngine "1" *-left- "6" Filter
FilterEngine "1" *-- "2" Modulator
BW4LPHP "1" *-- "1..*"  QuadFilter
Modulator <|-- StepSequencer
Modulator <|--- Oscillator
WaveGenerator *-- WaveType
Oscillator *- WaveGenerator
MoogFilter *-- MoogType


@endum

